<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GrabAGun Email Card Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f0f0f;
    --surface: #1a1a1a;
    --border: #2e2e2e;
    --accent: #1477C9;
    --accent-light: #3a9ae8;
    --text: #f0f0f0;
    --muted: #888;
    --green: #22c55e;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'DM Sans', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 36px 20px; }
  .container { max-width: 1200px; margin: 0 auto; }

  header { margin-bottom: 32px; }
  header h1 { font-family: 'Bebas Neue', sans-serif; font-size: 44px; letter-spacing: 2px; color: #fff; line-height: 1; }
  header h1 span { color: var(--accent); }
  header p { color: var(--muted); font-size: 13px; margin-top: 5px; }

  /* 3-column layout: form | style | preview */
  .layout { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; align-items: start; }
  @media (max-width: 1000px) { .layout { grid-template-columns: 1fr 1fr; } }
  @media (max-width: 640px)  { .layout { grid-template-columns: 1fr; } }

  .panel { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 22px; }
  .panel h2 { font-family: 'Bebas Neue', sans-serif; font-size: 19px; letter-spacing: 1px; color: var(--accent-light); margin-bottom: 16px; padding-bottom: 10px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 8px; }

  .field { margin-bottom: 13px; }
  label { display: block; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: var(--muted); margin-bottom: 4px; }
  label .req { color: var(--accent); }
  input[type="text"], input[type="number"] { width: 100%; background: #111; border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-family: 'DM Sans', sans-serif; font-size: 13px; padding: 8px 10px; transition: border-color 0.2s; outline: none; }
  input[type="text"]:focus, input[type="number"]:focus { border-color: var(--accent); }
  .hint { font-size: 11px; color: var(--muted); margin-top: 3px; }
  .row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

  /* Color picker row */
  .color-row { display: flex; align-items: center; gap: 10px; }
  .color-row input[type="color"] { width: 36px; height: 32px; padding: 2px; border: 1px solid var(--border); border-radius: 5px; background: #111; cursor: pointer; flex-shrink: 0; }
  .color-row input[type="text"] { flex: 1; }

  /* Slider */
  .slider-row { display: flex; align-items: center; gap: 10px; }
  .slider-row input[type="range"] { flex: 1; accent-color: var(--accent); }
  .slider-val { font-size: 12px; color: var(--text); font-weight: 700; min-width: 36px; text-align: right; }

  /* Toggle */
  .toggle-row { display: flex; align-items: center; gap: 8px; margin-bottom: 13px; cursor: pointer; user-select: none; }
  .toggle-row input[type="checkbox"] { width: 14px; height: 14px; accent-color: var(--accent); cursor: pointer; }
  .toggle-row span { font-size: 12px; color: var(--muted); }

  /* Segmented control */
  .seg { display: flex; gap: 4px; }
  .seg button { flex: 1; background: #111; border: 1px solid var(--border); border-radius: 5px; color: var(--muted); font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 700; padding: 6px 4px; cursor: pointer; transition: all 0.15s; }
  .seg button.active { background: var(--accent); border-color: var(--accent); color: #fff; }

  hr.div { border: none; border-top: 1px solid var(--border); margin: 14px 0; }

  .btn-generate { width: 100%; margin-top: 4px; background: var(--accent); color: #fff; border: none; border-radius: 6px; font-family: 'Bebas Neue', sans-serif; font-size: 20px; letter-spacing: 1px; padding: 12px; cursor: pointer; transition: background 0.2s; }
  .btn-generate:hover { background: var(--accent-light); }
  .status { font-size: 12px; margin-top: 7px; min-height: 16px; color: var(--green); font-weight: 600; }

  /* Preview panel */
  .preview-panel { position: sticky; top: 20px; }
  .preview-wrap { background: #e0e0e0; border-radius: 8px; padding: 14px; }
  .output-header { display: flex; justify-content: space-between; align-items: center; margin: 14px 0 5px; }
  .output-header span { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: var(--muted); }
  .btn-copy { background: transparent; border: 1px solid var(--border); border-radius: 5px; color: var(--text); font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 700; padding: 4px 12px; cursor: pointer; transition: all 0.2s; }
  .btn-copy:hover { border-color: var(--accent); color: var(--accent); }
  .btn-copy.copied { border-color: var(--green); color: var(--green); }
  .code-box { background: #0a0a0a; border: 1px solid var(--border); border-radius: 6px; padding: 11px; font-family: 'Courier New', monospace; font-size: 10px; line-height: 1.5; color: #999; max-height: 200px; overflow-y: auto; white-space: pre-wrap; word-break: break-all; }

  .swatch-preview { width: 14px; height: 14px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.15); display: inline-block; vertical-align: middle; margin-left: 4px; }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>GrabAGun <span>Email</span> Generator</h1>
    <p>Fill in product details + adjust styling ‚Üí copy ready-to-paste HTML</p>
  </header>

  <div class="layout">

    <!-- COL 1: PRODUCT DETAILS -->
    <div class="panel">
      <h2>üì¶ Product Details</h2>

      <div class="field">
        <label>URL Slug <span class="req">*</span></label>
        <input type="text" id="slug" placeholder="kriss-vector-crb-g3-9mm-16-barrel-40-rounds" />
        <p class="hint">Everything after grabagun.com/ (no .html)</p>
      </div>

      <div class="field">
        <label>Product Title <span class="req">*</span></label>
        <input type="text" id="title" placeholder='Kriss Vector CRB G3 9mm 16" Barrel 40-Rounds' />
      </div>

      <div class="field">
        <label>Image Path <span class="req">*</span></label>
        <input type="text" id="imagePath" placeholder="/K/r/Kriss-Vector-CRB-G3-KV90-CBL22.jpg" />
        <p class="hint">Path after grabagun.com/media/catalog/product</p>
      </div>

      <div class="row2">
        <div class="field">
          <label>Sale Price <span class="req">*</span></label>
          <input type="text" id="salePrice" placeholder="537.09" />
        </div>
        <div class="field">
          <label>Original Price</label>
          <input type="text" id="origPrice" placeholder="799.00" />
        </div>
      </div>

      <hr class="div">

      <label class="toggle-row">
        <input type="checkbox" id="promoToggle" checked />
        <span>Include promo link text</span>
      </label>
      <div class="field" id="promoField">
        <input type="text" id="promoText" placeholder="Save $350 On Saint Victor Rifles" />
      </div>

      <hr class="div">

      <button class="btn-generate" onclick="generate()">‚ö° Generate HTML</button>
      <div class="status" id="status"></div>
    </div>

    <!-- COL 2: STYLE SETTINGS -->
    <div class="panel">
      <h2>üé® Style Settings</h2>

      <!-- Button color -->
      <div class="field">
        <label>Button Color <span id="btnColorSwatch" class="swatch-preview" style="background:#1477C9;"></span></label>
        <div class="color-row">
          <input type="color" id="btnColorPicker" value="#1477C9" oninput="syncColor('btnColor','btnColorPicker','btnColorSwatch')" />
          <input type="text"  id="btnColor" value="#1477C9" oninput="syncColorFromText('btnColor','btnColorPicker','btnColorSwatch')" placeholder="#1477C9" />
        </div>
      </div>

      <!-- Button text color -->
      <div class="field">
        <label>Button Text Color <span id="btnTextSwatch" class="swatch-preview" style="background:#ffffff;"></span></label>
        <div class="color-row">
          <input type="color" id="btnTextPicker" value="#ffffff" oninput="syncColor('btnTextColor','btnTextPicker','btnTextSwatch')" />
          <input type="text"  id="btnTextColor" value="#ffffff" oninput="syncColorFromText('btnTextColor','btnTextPicker','btnTextSwatch')" placeholder="#ffffff" />
        </div>
      </div>

      <!-- Button label -->
      <div class="field">
        <label>Button Label</label>
        <input type="text" id="btnLabel" value="BUY NOW" placeholder="BUY NOW" />
      </div>

      <!-- Button corners -->
      <div class="field">
        <label>Button Corners</label>
        <div class="seg" id="radiusSeg">
          <button class="active" onclick="setSeg('radiusSeg',this,'0px')">Square</button>
          <button onclick="setSeg('radiusSeg',this,'4px')">Slight</button>
          <button onclick="setSeg('radiusSeg',this,'8px')">Rounded</button>
        </div>
      </div>

      <hr class="div">

      <!-- Band background -->
      <div class="field">
        <label>Info Band Color <span id="bandSwatch" class="swatch-preview" style="background:#f5f5f5;"></span></label>
        <div class="color-row">
          <input type="color" id="bandColorPicker" value="#f5f5f5" oninput="syncColor('bandColor','bandColorPicker','bandSwatch')" />
          <input type="text"  id="bandColor" value="#f5f5f5" oninput="syncColorFromText('bandColor','bandColorPicker','bandSwatch')" placeholder="#f5f5f5" />
        </div>
      </div>

      <!-- Promo link color -->
      <div class="field">
        <label>Promo Link Color <span id="promoSwatch" class="swatch-preview" style="background:#1477C9;"></span></label>
        <div class="color-row">
          <input type="color" id="promoColorPicker" value="#1477C9" oninput="syncColor('promoColor','promoColorPicker','promoSwatch')" />
          <input type="text"  id="promoColor" value="#1477C9" oninput="syncColorFromText('promoColor','promoColorPicker','promoSwatch')" placeholder="#1477C9" />
        </div>
      </div>

      <hr class="div">

      <!-- Image size -->
      <div class="field">
        <label>Image Size <span class="slider-val" id="imgSizeVal">260px</span></label>
        <div class="slider-row">
          <input type="range" id="imgSize" min="160" max="420" value="260" oninput="document.getElementById('imgSizeVal').textContent=this.value+'px'" />
        </div>
      </div>

      <!-- Title font size -->
      <div class="field">
        <label>Title Font Size <span class="slider-val" id="titleSizeVal">15px</span></label>
        <div class="slider-row">
          <input type="range" id="titleSize" min="12" max="22" value="15" oninput="document.getElementById('titleSizeVal').textContent=this.value+'px'" />
        </div>
      </div>

      <!-- Sale price size -->
      <div class="field">
        <label>Sale Price Size <span class="slider-val" id="priceSizeVal">22px</span></label>
        <div class="slider-row">
          <input type="range" id="priceSize" min="16" max="36" value="22" oninput="document.getElementById('priceSizeVal').textContent=this.value+'px'" />
        </div>
      </div>

      <hr class="div">

      <!-- Card max width -->
      <div class="field">
        <label>Card Max Width</label>
        <div class="seg" id="widthSeg">
          <button onclick="setSeg('widthSeg',this,'500px')">500px</button>
          <button class="active" onclick="setSeg('widthSeg',this,'600px')">600px</button>
          <button onclick="setSeg('widthSeg',this,'680px')">680px</button>
        </div>
      </div>

      <!-- Show original price -->
      <label class="toggle-row">
        <input type="checkbox" id="showOrigPrice" checked />
        <span>Show original (crossed out) price</span>
      </label>

    </div>

    <!-- COL 3: PREVIEW + OUTPUT -->
    <div class="panel preview-panel">
      <h2>üëÅ Preview</h2>
      <div class="preview-wrap" id="preview">
        <div style="text-align:center;padding:40px 0;color:#aaa;font-size:13px;">Fill in the form and click Generate</div>
      </div>
      <div class="output-header">
        <span>HTML Output</span>
        <button class="btn-copy" id="copyBtn" onclick="copyHTML()">Copy HTML</button>
      </div>
      <div class="code-box" id="codeBox"><!-- output appears here --></div>
    </div>

  </div>
</div>

<script>
  // --- Segment control ---
  const segValues = {};
  function setSeg(groupId, btn, value) {
    document.querySelectorAll(`#${groupId} button`).forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    segValues[groupId] = value;
  }
  segValues['radiusSeg'] = '0px';
  segValues['widthSeg']  = '600px';

  // --- Color sync ---
  function syncColor(textId, pickerId, swatchId) {
    const val = document.getElementById(pickerId).value;
    document.getElementById(textId).value = val;
    document.getElementById(swatchId).style.background = val;
  }
  function syncColorFromText(textId, pickerId, swatchId) {
    const val = document.getElementById(textId).value;
    if (/^#[0-9a-fA-F]{6}$/.test(val)) {
      document.getElementById(pickerId).value = val;
      document.getElementById(swatchId).style.background = val;
    }
  }

  // --- Promo toggle ---
  document.getElementById('promoToggle').addEventListener('change', function() {
    document.getElementById('promoField').style.display = this.checked ? 'block' : 'none';
  });

  // --- Build HTML ---
  function buildHTML(opts) {
    const { slug, title, imagePath, salePrice, origPrice, promoText,
            btnColor, btnTextColor, btnLabel, btnRadius,
            bandColor, promoColor, imgSize, titleSize, priceSize,
            cardWidth, showOrig } = opts;

    const baseUrl = `https://grabagun.com/${slug}.html`;
    const imgUrl  = `https://grabagun.com/media/catalog/product${imagePath}?quality=60&fit=bounds&height=${imgSize}&width=${imgSize}`;

    const promoRow = promoText ? `
                    <tr>
                      <td style="font-family:Arial,Helvetica,sans-serif;font-size:13px;line-height:18px;padding:0 0 8px 0;">
                        <a href="${baseUrl}" target="_blank" style="color:${promoColor};text-decoration:none;">${promoText}</a>
                      </td>
                    </tr>` : '';

    const origPriceCell = showOrig && origPrice ? `
                            <td style="font-family:Arial,Helvetica,sans-serif;font-size:14px;line-height:20px;color:#9B9B9B;text-decoration:line-through;white-space:nowrap;vertical-align:middle;">
                              $${origPrice}
                            </td>` : '';

    return `<!-- GrabAGun Email Card | ${slug} -->
<table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="background:#ffffff;">
  <tr>
    <td>
      <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="max-width:${cardWidth};margin:0 auto;background:#ffffff;border:1px solid #E0E0E0;">

        <!-- PRODUCT IMAGE -->
        <tr>
          <td align="center" style="background:#ffffff;padding:20px;border-bottom:1px solid #E0E0E0;line-height:0;font-size:0;">
            <a href="${baseUrl}" target="_blank" style="display:inline-block;border:0;text-decoration:none;">
              <img src="${imgUrl}" alt="${title}" width="${imgSize}" height="${imgSize}" border="0"
                   style="display:block;width:100%;max-width:${imgSize}px;height:auto;border:0;outline:none;text-decoration:none;">
            </a>
          </td>
        </tr>

        <!-- INFO + CTA -->
        <tr>
          <td style="padding:14px 16px;background:${bandColor};">
            <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0">
              <tr>

                <!-- LEFT: title, promo, pricing (fixed width so button doesn't push it around) -->
                <td class="info-left" valign="middle" style="width:68%;padding-right:14px;">
                  <!-- Title -->
                  <div style="font-family:Arial,Helvetica,sans-serif;font-size:${titleSize}px;line-height:${parseInt(titleSize)+5}px;font-weight:700;color:#111111;margin:0 0 5px 0;">
                    <a href="${baseUrl}" target="_blank" style="color:#111111;text-decoration:none;">${title}</a>
                  </div>
                  ${promoText ? `<!-- Promo -->
                  <div style="font-family:Arial,Helvetica,sans-serif;font-size:13px;line-height:18px;margin:0 0 8px 0;">
                    <a href="${baseUrl}" target="_blank" style="color:${promoColor};text-decoration:none;">${promoText}</a>
                  </div>` : ''}
                  <!-- Pricing -->
                  <table role="presentation" cellspacing="0" cellpadding="0" border="0">
                    <tr>
                      <td style="font-family:Arial,Helvetica,sans-serif;font-size:${priceSize}px;line-height:${parseInt(priceSize)+4}px;font-weight:800;color:#111111;padding-right:10px;white-space:nowrap;">$${salePrice}</td>
                      ${showOrig && origPrice ? `<td style="font-family:Arial,Helvetica,sans-serif;font-size:14px;line-height:20px;color:#9B9B9B;text-decoration:line-through;white-space:nowrap;vertical-align:middle;">$${origPrice}</td>` : ''}
                    </tr>
                  </table>
                </td>

                <!-- RIGHT: BUY NOW button -->
                <td class="info-right" valign="middle" align="right" style="width:32%;white-space:nowrap;">
                  <a href="${baseUrl}" target="_blank"
                     style="display:inline-block;background:${btnColor};color:${btnTextColor};font-family:Arial,Helvetica,sans-serif;font-size:13px;font-weight:700;text-decoration:none;padding:13px 22px;border-radius:${btnRadius};white-space:nowrap;letter-spacing:0.5px;">
                    ${btnLabel}
                  </a>
                </td>

              </tr>
            </table>
          </td>
        </tr>

      </table>
    </td>
  </tr>
</table>

<style type="text/css">
@media screen and (max-width:480px) {
  .info-left  { display:block !important; width:100% !important; padding-right:0 !important; }
  .info-right { display:block !important; width:100% !important; text-align:left !important; padding-top:12px !important; }
  .info-right a { display:block !important; text-align:center !important; padding:14px 0 !important; width:100% !important; }
}
</style>`;
  }

  function getOpts() {
    return {
      slug:         document.getElementById('slug').value.trim().replace(/^\/+|\.html$/g, ''),
      title:        document.getElementById('title').value.trim(),
      imagePath:    document.getElementById('imagePath').value.trim(),
      salePrice:    document.getElementById('salePrice').value.trim().replace('$',''),
      origPrice:    document.getElementById('origPrice').value.trim().replace('$',''),
      promoText:    document.getElementById('promoToggle').checked ? document.getElementById('promoText').value.trim() : '',
      btnColor:     document.getElementById('btnColor').value || '#1477C9',
      btnTextColor: document.getElementById('btnTextColor').value || '#ffffff',
      btnLabel:     document.getElementById('btnLabel').value || 'BUY NOW',
      btnRadius:    segValues['radiusSeg'] || '0px',
      bandColor:    document.getElementById('bandColor').value || '#f5f5f5',
      promoColor:   document.getElementById('promoColor').value || '#1477C9',
      imgSize:      document.getElementById('imgSize').value,
      titleSize:    document.getElementById('titleSize').value,
      priceSize:    document.getElementById('priceSize').value,
      cardWidth:    segValues['widthSeg'] || '600px',
      showOrig:     document.getElementById('showOrigPrice').checked,
    };
  }

  function generate() {
    const opts = getOpts();
    if (!opts.slug || !opts.title || !opts.imagePath || !opts.salePrice) {
      document.getElementById('status').textContent = '‚ö† Please fill in all required fields.';
      document.getElementById('status').style.color = '#ef4444';
      return;
    }
    const html = buildHTML(opts);
    document.getElementById('preview').innerHTML = html;
    document.getElementById('codeBox').textContent = html;
    document.getElementById('status').textContent = '‚úì Generated!';
    document.getElementById('status').style.color = '#22c55e';
    window._generatedHTML = html;
  }

  function copyHTML() {
    if (!window._generatedHTML) { alert('Generate HTML first.'); return; }
    navigator.clipboard.writeText(window._generatedHTML).then(() => {
      const btn = document.getElementById('copyBtn');
      btn.textContent = '‚úì Copied!';
      btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'Copy HTML'; btn.classList.remove('copied'); }, 2000);
    });
  }

  // Live preview re-renders on style changes
  ['btnColor','btnTextColor','btnLabel','bandColor','promoColor','imgSize','titleSize','priceSize'].forEach(id => {
    document.getElementById(id).addEventListener('input', () => { if (window._generatedHTML) generate(); });
  });
  document.getElementById('showOrigPrice').addEventListener('change', () => { if (window._generatedHTML) generate(); });
  document.querySelectorAll('.seg button').forEach(btn => {
    btn.addEventListener('click', () => { if (window._generatedHTML) setTimeout(generate, 10); });
  });

  document.querySelectorAll('input[type="text"], input[type="number"]').forEach(el => {
    el.addEventListener('keydown', e => { if (e.key === 'Enter') generate(); });
  });
</script>
</body>
</html>
